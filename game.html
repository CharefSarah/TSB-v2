<!DOCTYPE html>

<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The Shield-bearers</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link rel="shortcut icon" href="assets/img/ico.ico" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w=="
    crossorigin="anonymous" />
  <link rel="stylesheet" href="assets/css/game/game.css">
  <link rel="stylesheet" href="assets/css/game/gamequeries.css">
</head>

<body id="game">
  <!-- Video pour les cinematiques. -->
  <video id="cinematic" controls="hidden" src="assets/video/14.mp4" type="video/mp4"></video>

  <div class="bg-animation thunder">
    <!-- STAR ANIMATION -->
    <div id='stars' class="dustyday fxhide"></div>
    <div id='stars2' class="dustyday fxhide"></div>
    <!-- Pluie -->
    <canvas id="canvas1" class="rainyday fxhide"></canvas>
    <canvas id="canvas2" class="rainyday fxhide"></canvas>
    <canvas id="canvas3" class="rainyday fxhide"></canvas>
    <!-- piste audio -->
    <audio src="" id="music_audio" style="display:none"></audio>
    <audio src="" id="sound_effect_audio" style="display:none"></audio>
    <audio src="" id="sound_effect_audio_2" style="display:none"></audio>
    <audio src="" id="sound_effect_audio_3" style="display:none"></audio>
    <audio src="" id="sound_effect_audio_4" style="display:none"></audio>
  </div>

  <main id="d2" class="bg-animation">
    <!--Level-->>
    <div class="info">
      <p class="level">Niveau : <span class="round" id="round"></span></p>
    </div>
    <!-- ------------------------ Cards avec les persos ------------------------ -->
    <div class="combat">
      <!--Card Hero-->
      <div class="cardCombat cardHero hero">
        <div class="cardInt">
          <div class="stats">
            <p class="name" id="heroName">
              Rodric
            </p>
            <div class="life HP">
              <img id="heart0" src="assets/img/bx_bxs-heart.png" alt="">
              <img id="heart1" src="assets/img/bx_bxs-heart.png" alt="">
              <img id="heart2" src="assets/img/bx_bxs-heart.png" alt="">
              <img id="heart3" src="assets/img/bx_bxs-heart.png" alt="">
              <img id="heart4" src="assets/img/bx_bxs-heart.png" alt="">
              <img id="heart5" src="assets/img/bx_bxs-heart.png" alt="">
              <img id="heart6" src="assets/img/bx_bxs-heart.png" alt="">
              <img id="heart7" src="assets/img/bx_bxs-heart.png" alt="">
              <img id="heart8" src="assets/img/bx_bxs-heart.png" alt="">
              <img id="heart9" src="assets/img/bx_bxs-heart.png" alt="">
            </div>
            <p>PV : <span id="heroHealth"></span></p>
            <div class="healthBar" id="healthBar" value="" max="1000">
              <div class="hpBar bar" id="bar">
              </div>
            </div>
            <p>Mana :</p>
            <div class="mana" id="heroManaBar" value="0" max="1000">
              <div class="manaBar" id="manaBar"></div>
            </div>
          </div>
          <div class="portrait">
            <div class="combatTextHero"></div>
            <img src="" class="heroImg" id="heroImg" alt="">
          </div>
        </div>
      </div>

      <!--Card Ennemy-->
      <div class="cardCombat cardEnnemy">
        <div class="cardInt">
          <div class="portrait">
            <div class="combatTextEnnemy"></div>
            <img class="badguyImg" id="badguyImg" src="" alt="">
          </div>
          <div class="stats ennemyStats">
            <p class="name" id="badGuyName">

            </p>
            <p class="HP">PV : <span id="badGuyHealth"></span></p>
            <div class="hp" id="badguyHealthBar" value="1000" max="1000">
              <div class="badguyBar" id="badguyBar"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ------------------------------- Control ------------------------------- -->
    <div class="control">
      <!--Button -->
      <button class="controlButton button1" id="baseAttack">
        <div class="attackImg">
          <img src="assets/img/gourdin.png" alt="">
        </div>
        <div>
          <span id="basicAttackName"></span><span id="basicAttack"></span>
        </div>
      </button>
      <!--Button -->
      <button class="controlButton button2" id="heavyAttack" disabled>
        <div class="attackImg">
          <img src="assets/img/bouclier.png" alt="">
        </div>
        <div>
          <span id="bigAttackName"></span><span id="bigAttack"></span>
        </div>
      </button>
      <!--Button -->
      <button class="controlButton button2" id="ultiAttack" disabled>
        <div class="attackImg">
          <img src="assets/img/epee.png" alt="">
        </div>
        <div>
          <span id="ultimateAttackName"></span><span id="ultimateAttack"></span>
        </div>
      </button>
      <!--Button -->
      <button class="controlButton button4" id="potion" onclick="playP()">
        <div class="attackImg potion">
          <img class="popo" src="assets/img/potion.png" alt="">
        </div>
        <div class="combatTextPotion"></div>
        <p class="attackName" id="stockPotion">
          Potion
        </p>
      </button>
    </div>

    <!--Option Toggle-->
    <div class="settings">
      <img src="assets/img/settingsKog.png" alt="">
    </div>

    <!-- Option Panel-->
    <div class="settingsPanel settings-hidden">
      <p>Param√®tres :</p>
      <div class="panelInside">
        <div class="panelLeft">
          <p class="panelTitle">Son : </p>
          <div class="SFX">
            <p>Volume SFX : </p>
            <input type="range" class="SFX_volume">
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider round"></span>
            </label>
          </div>
          <div class="music">
            <p>Volume Musique :</p>
            <input type="range" class="music_volume">
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider round"></span>
            </label>
          </div>
        </div>
        <div class="panelRight">
          <p class="panelTitle">Langue : </p>
          <div class="selectLanguage">
            <img class="flag active" src="assets/img/FRF.PNG" alt="">
            <img class="flag" src="assets/img/UKF.png" alt="">
          </div>
        </div>
      </div>
      <button class="settingsValidate">
        Valider
      </button>
    </div>

    <!-- ------------------------------- Sidebar ------------------------------- -->
    <div class="side">
      <div class="sidebarBg"></div>
      <div class="sidebar"></div>
    </div>

  </main>

  </div>
  <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"
    integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30=" crossorigin="anonymous"></script>
  <script src="assets/js/soundDesign.js"></script>
  <script src="assets/js/script.js"></script>
  <!-- Effects -->
  <script>
    var canvas1 = document.getElementById('canvas1');
    var canvas2 = document.getElementById('canvas2');
    var canvas3 = document.getElementById('canvas3');
    var ctx1 = canvas1.getContext('2d');
    var ctx2 = canvas2.getContext('2d');
    var ctx3 = canvas3.getContext('2d');

    var rainthroughnum = 500;
    var speedRainTrough = 25;
    var RainTrough = [];

    var rainnum = 500;
    var rain = [];

    var lightning = [];
    var lightTimeCurrent = 0;
    var lightTimeTotal = 0;

    var w = canvas1.width = canvas2.width = canvas3.width = window.innerWidth;
    var h = canvas1.height = canvas2.height = canvas3.height = window.innerHeight;
    window.addEventListener('resize', function () {
      w = canvas1.width = canvas2.width = canvas3.width = window.innerWidth;
      h = canvas1.height = canvas2.height = canvas3.height = window.innerHeight;
    });

    function random(min, max) {
      return Math.random() * (max - min + 1) + min;
    }

    function clearcanvas1() {
      ctx1.clearRect(0, 0, w, h);
    }

    function clearcanvas2() {
      ctx2.clearRect(0, 0, canvas2.width, canvas2.height);
    }

    function clearCanvas3() {
      ctx3.globalCompositeOperation = 'destination-out';
      ctx3.fillStyle = 'rgba(0,0,0,' + random(1, 30) / 100 + ')';
      ctx3.fillRect(0, 0, w, h);
      ctx3.globalCompositeOperation = 'source-over';
    };

    function createRainTrough() {
      for (var i = 0; i < rainthroughnum; i++) {
        RainTrough[i] = {
          x: random(0, w),
          y: random(0, h),
          length: Math.floor(random(1, 830)),
          opacity: Math.random() * 0.2,
          xs: random(-2, 2),
          ys: random(10, 20)
        };
      }
    }

    function createRain() {
      for (var i = 0; i < rainnum; i++) {
        rain[i] = {
          x: Math.random() * w,
          y: Math.random() * h,
          l: Math.random() * 1,
          xs: -4 + Math.random() * 4 + 2,
          ys: Math.random() * 10 + 10
        };
      }
    }

    function createLightning() {
      var x = random(100, w - 100);
      var y = random(0, h / 4);

      var createCount = random(1, 3);
      for (var i = 0; i < createCount; i++) {
        single = {
          x: x,
          y: y,
          xRange: random(5, 30),
          yRange: random(10, 25),
          path: [{
            x: x,
            y: y
          }],
          pathLimit: random(40, 55)
        };
        lightning.push(single);
      }
    };

    function drawRainTrough(i) {
      ctx1.beginPath();
      var grd = ctx1.createLinearGradient(0, RainTrough[i].y, 0, RainTrough[i].y + RainTrough[i].length);
      grd.addColorStop(0, "rgba(255,255,255,0)");
      grd.addColorStop(1, "rgba(255,255,255," + RainTrough[i].opacity + ")");

      ctx1.fillStyle = grd;
      ctx1.fillRect(RainTrough[i].x, RainTrough[i].y, 1, RainTrough[i].length);
      ctx1.fill();
    }

    function drawRain(i) {
      ctx2.beginPath();
      ctx2.moveTo(rain[i].x, rain[i].y);
      ctx2.lineTo(rain[i].x + rain[i].l * rain[i].xs, rain[i].y + rain[i].l * rain[i].ys);
      ctx2.strokeStyle = 'rgba(174,194,224,0.5)';
      ctx2.lineWidth = 1;
      ctx2.lineCap = 'round';

    }

    function drawLightning() {
      for (var i = 0; i < lightning.length; i++) {
        var light = lightning[i];

        light.path.push({
          x: light.path[light.path.length - 1].x + (random(0, light.xRange) - (light.xRange / 2)),
          y: light.path[light.path.length - 1].y + (random(0, light.yRange))
        });

        if (light.path.length > light.pathLimit) {
          lightning.splice(i, 1);
        }

        ctx3.strokeStyle = 'rgba(255, 255, 255, .1)';
        ctx3.lineWidth = 3;
        if (random(0, 15) === 0) {
          ctx3.lineWidth = 6;
        }
        if (random(0, 30) === 0) {
          ctx3.lineWidth = 8;
        }

        ctx3.beginPath();
        ctx3.moveTo(light.x, light.y);
        for (var pc = 0; pc < light.path.length; pc++) {
          ctx3.lineTo(light.path[pc].x, light.path[pc].y);
        }
        if (Math.floor(random(0, 30)) === 1) { //to fos apo piso
          ctx3.fillStyle = 'rgba(255, 255, 255, ' + random(1, 3) / 100 + ')';
          ctx3.fillRect(0, 0, w, h);
        }
        ctx3.lineJoin = 'miter';

      }
    };

    function animateRainTrough() {
      clearcanvas1();
      for (var i = 0; i < rainthroughnum; i++) {
        if (RainTrough[i].y >= h) {
          RainTrough[i].y = h - RainTrough[i].y - RainTrough[i].length * 5;
        } else {
          RainTrough[i].y += speedRainTrough;
        }
        drawRainTrough(i);
      }
    }

    function animateRain() {
      clearcanvas2();
      for (var i = 0; i < rainnum; i++) {
        rain[i].x += rain[i].xs;
        rain[i].y += rain[i].ys;
        if (rain[i].x > w || rain[i].y > h) {
          rain[i].x = Math.random() * w;
          rain[i].y = -20;
        }
        drawRain(i);
      }
    }

    function animateLightning() {
      clearCanvas3();
      lightTimeCurrent++;
      if (lightTimeCurrent >= lightTimeTotal) {
        createLightning();
        lightTimeCurrent = 0;
        lightTimeTotal = 200; //rand(100, 200)
      }
      drawLightning();
    }

    function init() {
      createRainTrough();
      createRain();
      window.addEventListener('resize', createRainTrough);
    }
    init();

    function animloop() {
      animateRainTrough();
      animateRain();
      animateLightning();
      requestAnimationFrame(animloop);
    }
    animloop();
  </script>

</body>

</html>